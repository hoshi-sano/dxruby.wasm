<!DOCTYPE html>
<html>
  <head>
    <meta charset= "utf-8" />
    <title>DXRuby.wasm Example</title>
    <script type="module" src="./dist/load_ruby_script.js"></script>
    <script type="text/ruby" data-eval="async">
      require "dxruby_wasm"

      version = DXRubyWasm::VERSION
      JS.global[:document].getElementById("dxruby-out")[:innerText] = "DXRubyWasm ver.#{version}"

      rect = Image.new(30, 30, C_GREEN)
      sp = Sprite.new(0, 0, rect)
      logo = Image.load("logo.png")

      logo_y = 0
      speed = 2

      logo2 = nil
      se = Sound.new("maou_se_8bit22.wav")
      Window.loop do
        logo2 ||= Image.load("logo.png")
        sp.x += Input.x * speed
        sp.y += Input.y * speed
        logo_y += speed
        logo_y = 0 if logo_y > Window.height
        se.play if se && logo_y.zero?

        Sprite.draw([sp])
        Window.draw(0, logo_y, logo)
        Window.draw(0, Window.height-logo_y, logo2)
      end
    </script>
  </head>

  <body>
    <div id="dxruby-out"></div>
    <canvas id="dxruby-canvas"></canvas>
  </body>
</html>
